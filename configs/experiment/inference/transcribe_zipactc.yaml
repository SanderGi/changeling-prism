# @package _global_

# This config executes inference with zipactc:
# Set data field when calling
# eg. python src/main.py experiment=inference/transcribe_zipactc data=fleurs task_name=inf_fleurs_zipactc

defaults:
  - override /logger: csv
  - override /model: null
  - override /model/net: null

task_name: ??? # pass inf_<data>_<model> when calling. This will create output dirs accordingly
tags: ["zipactc","inference"]

seed: 42

train: false
test: false
distributed_predict: True

inference:
  num_workers: 15 # number of parallel workers for distributed inference, set acc to gpu memory
  passthrough_keys: ["target", "split", "utt_id", "metadata_idx", "lang_sym"]
  out_file: ${paths.output_dir}/transcription.json
  # an object (or fn that creates such an object) with __call__ method to transcribe single speech
  inference_runner:
    _target_: src.model.zipa.zipformer_crctc.builders.build_zipactc_inference
    work_dir: ${paths.cache_dir}/zipactc
    bpe_model: src/model/zipa/resources/unigram_127.model
    hf_repo: ???