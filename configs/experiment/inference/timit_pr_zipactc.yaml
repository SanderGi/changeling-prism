# @package _global_

# This config executes phoneme recognition inference with zipa-ctc
# python src/main.py experiment=inference/timit_pr_zipactc

defaults:
  - override /model: phone_recognition # do not matter, only to satisfy requirement
  - override /model/net: zipactc # do not matter, only to satisfy requirement
  - override /data: timit
  - override /logger: csv

task_name: "inf_timit_pr_zipactc"
tags: ["inf_timit_pr_zipactc"]

seed: 42

train: false
test: false
distributed_predict: True

data:
  tokenizer:
    _target_: src.core.ipa_utils.IPATokenizer
  mask_probability: 0.0

inference:
  num_workers: 10 # number of parallel workers for distributed inference
  passthrough_keys: ["phones", "utt_id", "split", "masked_phones"] # keys from dataset to be passed to output
  out_file: ${paths.output_dir}/timit_zipa${inference.inference_runner.hf_repo}${data.mask_probability}.json
  inference_runner:
    _target_: src.model.zipa.zipformer_crctc.builders.build_zipactc_inference
    work_dir: ${paths.cache_dir}/zipactc
    bpe_model: src/model/zipa/resources/unigram_127.model
    hf_repo: ???